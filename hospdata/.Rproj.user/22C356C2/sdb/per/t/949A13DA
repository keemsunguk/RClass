{
    "contents" : "##\n#     Assignment 3 Part 3\n#     Finding the ranking of hospital of all state from \"outcome-of-care-measures.csv\"\n\n#     Parameters:\n#          outcome: “heart attack”, “heart failure”, or “pneumonia”\n#          num: Desired rank \n#    Return:\n#         Hospital.Name\n\nrankall<-function(outcome, num = \"best\") {\n     oc <- read.csv(\"outcome-of-care-measures.csv\", colClasses = \"character\")\n          \n     if(outcome == \"heart attack\") {\n          oc[,11] <-as.numeric(oc[,11])\n          gd1<-complete.cases(oc$State)\n          gd2<-complete.cases(oc[,11])\n          gd<-gd1&gd2\n          oc<-cbind(oc, gd)\n          di<-cbind(oc$Hospital.Name[oc$gd],oc$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack[oc$gd],oc$State[oc$gd])\n     } else if (outcome == \"heart failure\") {\n          oc[,17] <-as.numeric(oc[,17])\n          gd1<-complete.cases(oc$State)\n          gd2<-complete.cases(oc[,17])\n          gd<-gd1&gd2\n          oc<-cbind(oc, gd)\n          di<-cbind(oc$Hospital.Name[oc$gd],oc$Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure[oc$gd],oc$State[oc$gd])          \n     } else if (outcome == \"pneumonia\") {\n          oc[,23] <-as.numeric(oc[,23])\n          gd1<-complete.cases(oc$State)\n          gd2<-complete.cases(oc[,23])\n          gd<-gd1&gd2\n          oc<-cbind(oc, gd)\n          di<-cbind(oc$Hospital.Name[oc$gd],oc$Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia[oc$gd],oc$State[oc$gd])          \n     } else {\n          di<-NULL\n          stop(\"Invalid outcome\")\n     }\n     uni_states<-unique(di[,3])\n     states<-sort(uni_states)\n     allstate<-NULL\n     for(st in states[]) {  #\n          ldi<-di[di[,3]==st,]    #set up local di\n          if(length(ldi) == 0) {\n               thedata<-cbind(NA,state)\n          } else {\n               if(length(ldi) == 3) {\n                    ldi<-matrix(ldi,1,3)\n               }\n               mydata<-data.frame(Hospital.Name=as.character(ldi[,1]), Outcome=as.numeric(ldi[,2]), state=as.character(ldi[,3]))\n               md<-mydata[ with(mydata, order(Outcome, Hospital.Name)), ]\n     \n               if( num == \"best\") {\n                    thedata<-cbind(as.vector(md$Hospital.Name[md[,2]==min(md[,2])] ), st)\n               } else if(num == \"worst\") {\n                    thedata<-cbind(as.vector(md$Hospital.Name[md[,2]==max(md[,2])] ), st)\n               } else {\n                    rank = as.numeric(num)\n                    if(rank >=1 && rank < length(md[,2]) ) {\n                         thedata<-cbind(as.vector(md[rank,1] ), st)\n                    } else {\n                         thedata<-cbind(NA,st)\n                    }\n               }\n          }\n          allstate <-rbind(allstate,thedata)\n     }  #end of for loop\n     \n     retdata<-data.frame(hospital=as.character(allstate[,1]), state=as.character(allstate[,2]))\n}",
    "created" : 1407028764780.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3509753278",
    "id" : "949A13DA",
    "lastKnownWriteTime" : 1407090306,
    "path" : "~/Documents/R/Practice/hospdata/rankall.R",
    "project_path" : "rankall.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}